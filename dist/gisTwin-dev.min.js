!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).GisTwin=e()}(this,function(){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==typeof t?t:String(t)}(i.key),i)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function n(t,e){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");e=t;if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(n){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=u(n);return s(this,i?(t=u(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}var l=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.id=t.id,this._position=t.position,this._heading=t.heading,this._pitch=t.pitch,this._roll=t.roll,this._viewerArray=t.viewerArray}return o(e,[{key:"gotoFeat",value:function(){}},{key:"lookAtFeat",value:function(){}},{key:"focusToFeat",value:function(){}},{key:"setHeading",value:function(t){this._heading=t}},{key:"setPitch",value:function(t){this._pitch=t}},{key:"setRoll",value:function(t){this._roll=t}},{key:"setPosition",value:function(t){this._position=t}},{key:"getHeading",value:function(){return this._heading}},{key:"getPitch",value:function(){return this._pitch}},{key:"getRoll",value:function(){return this._roll}},{key:"getPosition",value:function(){return this._position}}]),e}(),c=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this._atmo=t.atmo,this._skyBox=t.skyBox,this._flg=t.flg,this._particleSystem=t.particleSystem,this._weather=t.weather,this._light=t.light,this._saturation=t.saturation,this._contrast=t.contrast,this._bloom=t.bloom,this._HDR=t.HDR}return o(e,[{key:"setLight",value:function(t){this._light=t}},{key:"setSaturation",value:function(t){this._saturation=t}},{key:"setContrast",value:function(t){this._contrast=t}},{key:"getLight",value:function(){return this.light}},{key:"getSaturation",value:function(){return this._saturation}},{key:"getContrast",value:function(){return this._contrast}},{key:"setBloom",value:function(t){this._bloom=t}},{key:"setHDR",value:function(){this._HDR=HDR}},{key:"getBloom",value:function(){return this._bloom}},{key:"getHDR",value:function(){return this._HDR}},{key:"setWeather",value:function(t){this._weather=t}},{key:"getWeather",value:function(){return this._weather}}]),e}(),f=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.id=t.id,this._type=t.type,this._name=t.name,this._source=t.source,this._level=t.level,this._display=t.display,this._position=t.position,this._featuresArray=[]}return o(e,[{key:"getFeatures",value:function(){return this._featuresArray}},{key:"addFeatures",value:function(){}},{key:"removeFeatures",value:function(e){var t=this._featuresArray.findIndex(function(t){return t.id===e});this._featuresArray.splice(t,1)}},{key:"setLevel",value:function(t){this._level=t}},{key:"getLevel",value:function(){return this._level}},{key:"setLayerDisplay",value:function(t){this._display=t}},{key:"getLayerDisplay",value:function(){return this._display}},{key:"setLayerPos",value:function(t){this._position=t}},{key:"getLayerPos",value:function(){return this._position}}]),e}(),h=function(){function t(){r(this,t)}return o(t,[{key:"setFeatureStyle",value:function(){}},{key:"setFeatureLabel",value:function(){}}]),t}(),y=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.id=t.id,this._geometry=t.geometry,this._property=t.property,this._position=t.position,this._display=t.display,this._featureStyle=new h(t.featureStyle),this._label=t.label}return o(e,[{key:"setPosition",value:function(t){this._position=t}},{key:"getPosition",value:function(){return this._position}},{key:"setDisplay",value:function(t){this._display=t}},{key:"getDisplay",value:function(){return this._display}},{key:"setStyle",value:function(t){this._featureStyle=new h(t)}},{key:"getStyle",value:function(){return this._featureStyle}},{key:"setLabel",value:function(t){this._label=t}},{key:"getLabel",value:function(){return this._label}}]),e}(),v="default",d=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this._controlMode=t.mode||v}return o(e,[{key:"setMode",value:function(t){this._controlMode=t}},{key:"getMode",value:function(){return this._controlMode}},{key:"setModeParams",value:function(t){this._params=t}},{key:"getModeParams",value:function(){return this._params}}]),e}(),e=function(){function t(){r(this,t)}return o(t,[{key:"addEventListener",value:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}},{key:"hasEventListener",value:function(t,e){var n;return void 0!==this._listeners&&void 0!==(n=this._listeners)[t]&&-1!==n[t].indexOf(e)}},{key:"removeEventListener",value:function(t,e){var n;void 0!==this._listeners&&void 0!==(t=this._listeners[t])&&-1!==(n=t.indexOf(e))&&t.splice(n,1)}},{key:"dispatchEvent",value:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t);t.target=null}}}}]),t}(),p=function(){t(i,e);var n=a(i);function i(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r(this,i),(t=n.call(this))._type=e.type,t.layerList=[],t.cameraList=[],t.layer=null,t.camera=null,t.feature=null,t.environment=null,t.UIControl=null,t}return o(i,[{key:"sendMsg",value:function(t,e,n,i){if("RegisterEvent"===t)this.addEventListener(e,n);else{try{("scene"===t?this:this[t])[e](n),console.log("".concat(t," - ").concat(e," - ").concat(n)),this.sendMsgToRender(e,n)}catch(t){console.error("SendMsg Error",t)}i&&this.addEventListener(e,i)}}},{key:"sendMsgToRender",value:function(t,e){}},{key:"setCoord",value:function(){}},{key:"setResolution",value:function(){}},{key:"getLayer",value:function(){}},{key:"addLayer",value:function(){}},{key:"setLayerSort",value:function(){this.layerList.sort(function(t,e){return t.level-e.level}),this.layer=this.layerList[0]}},{key:"removeLayer",value:function(e){var t=this.layerList.findIndex(function(t){return t.id==e});this.layerList.splice(t,1),this.layer=this.layerList[0]}},{key:"addCamera",value:function(){}},{key:"getCamera",value:function(){}},{key:"setUsedCamera",value:function(e){this.camera=this.cameraList.find(function(t){return t.id===e})}},{key:"removeCamera",value:function(e){var t=this.cameraList.findIndex(function(t){return t.id===e});this.cameraList.splice(t,1),this.camera.id==e&&(this.camera=this.cameraList[0])}},{key:"getEnvironment",value:function(){}},{key:"setFeature",value:function(){}},{key:"setEnvironment",value:function(){}},{key:"setUIControl",value:function(){}}]),i}(),_=function(){t(n,p);var e=a(n);function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r(this,n),(t=e.call(this,t)).ue4=window.ue.interface.broadcast,t.ue.interface.eventHandler=t.dispatchEvent,t}return o(n,[{key:"sendMsgToRender",value:function(t,e){this.ue4(t,e)}},{key:"addLayer",value:function(t){t=new m(t);this.layerList.push(t),this.setLayerSort()}},{key:"addCamera",value:function(t){t=new k(t);this.cameraList.push(t)}},{key:"setFeature",value:function(t){this.feature=new b(t)}},{key:"setEnvironment",value:function(t){this.environment=new g(t)}},{key:"setUIControl",value:function(t){this.UIControl=new w(t)}}]),n}(),k=function(){t(n,l);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),g=function(){t(n,c);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),m=function(){t(n,f);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n,[{key:"addFeatures",value:function(t){t=new b(t);this._featuresArray.push(t)}}]),n}(),b=function(){t(n,y);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),w=function(){t(n,d);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),L=function(){t(i,p);var n=a(i);function i(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r(this,i),(t=n.call(this,e))._cloudUrl=e.cloudUrl,t._webRtcApp=window.$WebRtcApp||{},t._webRtcApp.receivedMessagehandlerSet=t.dispatchEvent,t}return o(i,[{key:"sendMsgToRender",value:function(t,e){this._webRtcApp.sendMessageHandler(t,e)}},{key:"addLayer",value:function(t){t=new E(t);this.layerList.push(t),this.setLayerSort()}},{key:"addCamera",value:function(t){t=new R(t);this.cameraList.push(t)}},{key:"setFeature",value:function(t){this.feature=new S(t)}},{key:"setEnvironment",value:function(t){this.environment=new P(t)}},{key:"setUIControl",value:function(t){this.UIControl=new O(t)}}]),i}(),R=function(){t(n,l);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),P=function(){t(n,c);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),E=function(){t(n,f);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n,[{key:"addFeatures",value:function(t){t=new S(t);this._featuresArray.push(t)}}]),n}(),S=function(){t(n,y);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),O=function(){t(n,d);var e=a(n);function n(t){return r(this,n),e.call(this,t)}return o(n)}(),C="CLOUD",M="UE";return o(function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=(r(this,t),(e.type||"cloud").toUpperCase());return console.log("渲染源为： %c".concat(n),"color: red"),n===M?new _(e):n===C?new L(e):void 0})});
